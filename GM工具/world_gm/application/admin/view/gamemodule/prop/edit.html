
<!--<script type="text/javascript" src="http://www.daimajiayuan.com/download/jquery/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="http://cdn.bootcss.com/bootstrap-select/2.0.0-beta1/js/bootstrap-select.js"></script>
<link rel="stylesheet" type="text/css" href="http://cdn.bootcss.com/bootstrap-select/2.0.0-beta1/css/bootstrap-select.css">
<link href="http://netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">-->
<script type="text/javascript" src="__PUBLIC__/mail/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/mail/bootstrap-select.js"></script>
<link rel="stylesheet" type="text/css" href="__PUBLIC__/mail/bootstrap-select.css">
<link href="__PUBLIC__/mail/bootstrap.min.css" rel="stylesheet">
<script type="text/javascript">
    $(window).on('load', function () {
        $('.selectpicker').selectpicker({
            'selectedText': 'cat'
        });
        $('.selectpicker').click(function () {
            var a = $("#bs3Select").val();//console.log(a);
            $("#a").val(a);
            $("#ad").val(a);
        });
    });
</script>

<form id="add-form" class="form-horizontal" role="form" data-toggle="validator" method="POST" action="">

    <!--<div class="form-group">
        <input type="text" value="{$id}"/>
    </div>-->
    <div class="form-group">
        <label for="bs3Select" class="col-lg-2 control-label">数量</label>
        <div class="col-lg-10" id="mails" style="width: 100%;">
            <input type="hidden" value="{$id}" id="order"/>
            <!--<select class="form-control" id="id">
                <option value="1">金豆</option>
                <option value="2">房卡</option>
                <option value="3">钻石</option>
                <option value="4">转盘次数</option>
                <option value="5">10元手机话费</option>
                <option value="6">斗地主记牌器</option>
            </select>-->
            <select class="form-control" id="id" style="float: left;width: 33%;">
                {if condition="$list['id']==1"}
                    <option value="1" selected>金豆</option>
                    <option value="2">房卡</option>
                    <option value="3">钻石(之前的钻石)</option>
                    <option value="4">转盘次数(bsc给玩家显示钻石)</option>
                    <option value="5">10元手机话费</option>
                    <option value="6">斗地主记牌器</option>
                {elseif condition="$list['id']==2"/}
                    <option value="1">金豆</option>
                    <option value="2" selected>房卡</option>
                    <option value="3">钻石(之前的钻石)</option>
                    <option value="4">转盘次数(bsc给玩家显示钻石)</option>
                    <option value="5">10元手机话费</option>
                    <option value="6">斗地主记牌器</option>
                {elseif condition="$list['id']==3"/}
                    <option value="1">金豆</option>
                    <option value="2">房卡</option>
                    <option value="3" selected>钻石(之前的钻石)</option>
                    <option value="4">转盘次数(bsc给玩家显示钻石)</option>
                    <option value="5">10元手机话费</option>
                    <option value="6">斗地主记牌器</option>
                {elseif condition="$list['id']==4"/}
                    <option value="1">金豆</option>
                    <option value="2">房卡</option>
                    <option value="3">钻石(之前的钻石)</option>
                    <option value="4" selected>转盘次数(bsc给玩家显示钻石)</option>
                    <option value="5">10元手机话费</option>
                    <option value="6">斗地主记牌器</option>
                {elseif condition="$list['id']==5"/}
                    <option value="1">金豆</option>
                    <option value="2">房卡</option>
                    <option value="3">钻石(之前的钻石)</option>
                    <option value="4">转盘次数(bsc给玩家显示钻石)</option>
                    <option value="5" selected>10元手机话费</option>
                    <option value="6">斗地主记牌器</option>
                {else /}
                    <option value="1">金豆</option>
                    <option value="2">房卡</option>
                    <option value="3">钻石(之前的钻石)</option>
                    <option value="4">转盘次数(bsc给玩家显示钻石)</option>
                    <option value="5">10元手机话费</option>
                    <option value="6" selected>斗地主记牌器</option>
                {/if}
            </select>
            <input type="number" class="form-control" value="{$list['num']}" id="num" style="float: left;width: 33%;">
            <input type="number" class="form-control" value="{$list['prop']}" id="prop" style="float: left;width: 33%;">
            <!--<div class="addel wai">
                <div class="form-group target wn">

                </div>
                <a style="text-decoration:none;color:red;"> (* 金豆数量+房卡数量...)(最多只能加六个)</a>
                <input type="button" class="form-control" id="adds" value="+">
            </div>-->
        </div>
    </div>
    <div class="form-group">
        <label class="control-label col-xs-12 col-sm-2"></label>
        <div class="col-xs-12 col-sm-8">
            <button type="button" class="btn btn-success btn-embossed {:$auth->check('mail/sendmail/set')?'':'hide'}" id="sendMail">保存</button>
        </div>
    </div>
</form>
 <script type="text/javascript" src="__PUBLIC__/assets/libs/jcrop/js/jquery.min.js"></script>
<script type="text/javascript">
    $(function () {
        $("#ribbon").css("display","none");
    })
</script>
<script type="text/javascript">
    //增加,判断输入的数量是否为空
    $(document).on("click", "#adds", function() {
        var str = $(".shul").last().attr("id");
        var strs = String(str);
        var cd = strs.length;
        var arr = strs.substring(5,cd);
        var arrs = Number(arr)+1;

        if(strs=="undefined"){
            var num = $(".nei").length+1;
            var mails = $(".wn"),
                divs = "search_input_div" + num,
                sesa = "select" + num,
                ses = "input" + num;
            /*var s_strs = "<div class='nei' style='-margin-left:-41%;'>"+'<table style="position:relative;"><tbody><tr>'+'<td>'+"<input type='number' name='contactt[]' style='width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;' placeholder='请输入金豆数量' value='1' class='shul' id='"+ses+"'/>"+'</td>'+'<td>'+"<input type='number' name='contactt1[]' style='width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;' placeholder='请输入房卡数量' value='1' class='shul' id='"+ses+"'/>"+'</td>'+'<td><button type="button" class="btn btn-danger dels" style="margin-top:-35%;">-</button></td>'+"<td class='asd' style='position:absolute;margin-top:2.5%;width:70%;'></td>"+'<tr><tbody><table>'+"</div>";*/
            var s_strs = "<div class='nei' style='-margin-left:-41%;'>"+'<table style="position:relative;"><tbody><tr>'+'<td>'+'<select name="contactt[]" style="width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;"><option value="1">金豆</option><option value="2">房卡</option><option value="3">钻石</option></select>'+'</td>'+'<td>'+"<input type='number' name='contactt1[]' style='width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;' placeholder='请输入房卡数量' value='1' class='shul' id='"+ses+"'/>"+'</td>'+'<td><button type="button" class="btn btn-danger dels" style="margin-top:-35%;">-</button></td>'+"<td class='asd' style='position:absolute;margin-top:2.5%;width:70%;'></td>"+'<tr><tbody><table>'+"</div>";
            var neiDiv = $(".nei").size();
            if(neiDiv>6){
                alert("最多只能添加6个");
            }
            else {
                mails.append(s_strs);
                var count = 100;
                for(var i=1;i<count;i++){
                    $('#select'+i).comboSelect();
                }
            }
            $("input[name='contactt[]']:eq(0)").blur(function(){
                var val = $(this).val();
                var len = val.length;
                var arr = val.split('.');console.log(arr);
                if(val=""){
                    $(".asd:eq(0)").text('× 道具数量不能为空或者含有非法字符');
                    $(".asd:eq(0)").css({
                        'color':'red',
                        'font-size':'14px'
                    });
                    num1 = false;
                }
                else if(val!=""){
                    var point = /^\d{1,}$/;
                    if(point.test(val) && val.substring(0,1)!=="0"){
                        $(".asd:eq(0)").text('√ 输入正确');
                        $(".asd:eq(0)").css({
                            'color':'green',
                            'font-size':'14px'
                        });
                        num1 = true;

                    }
                    else {
                        $(".asd:eq(0)").text('× 首位数字必须大于零且不能输入小数');
                        $(".asd:eq(0)").css({
                            'color':'red',
                            'font-size':'14px'
                        });
                        num1 = false;
                    }
                }
            })
        }
        else {
            var num = Number(arrs);
            var mails = $(".wn"),
                divs = "search_input_div" + num,
                sesa = "select" + num,
                ses = "input" + num;
            /*var s_strs = "<div class='nei' style='-margin-left:-41%;'>"+'<table style="position:relative;"><tbody><tr>'+'<td>'+"<input type='number' name='contactt[]' style='width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;' placeholder='请输入金豆数量' value='1' class='shul' id='"+ses+"'/>"+'</td>'+'<td>'+"<input type='number' name='contactt1[]' style='width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;' placeholder='请输入房卡数量' value='1' class='shul' id='"+ses+"'/>"+'</td>'+'<td><button type="button" class="btn btn-danger dels" style="margin-top:-35%;">-</button></td>'+"<td class='asd' style='position:absolute;margin-top:2.5%;width:70%;'></td>"+'<tr><tbody><table>'+"</div>";*/
            var s_strs = "<div class='nei' style='-margin-left:-41%;'>"+'<table style="position:relative;"><tbody><tr>'+'<td>'+'<select name="contactt[]" style="width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;"><option value="1">金豆</option><option value="2">房卡</option><option value="3">钻石</option></select>'+'</td>'+'<td>'+"<input type='number' name='contactt1[]' style='width:100%;border: 1px #ccc solid;border-radius: 3px;height:40px;margin-bottom: 15px;' placeholder='请输入房卡数量' value='1' class='shul' id='"+ses+"'/>"+'</td>'+'<td><button type="button" class="btn btn-danger dels" style="margin-top:-35%;">-</button></td>'+"<td class='asd' style='position:absolute;margin-top:2.5%;width:70%;'></td>"+'<tr><tbody><table>'+"</div>";
            var neiDiv = $(".nei").size();
            if(neiDiv>5){
                alert("最多只能添加6个");
            }
            else {
                mails.append(s_strs);
                var count = 100;
                for(var i=1;i<count;i++){
                    $('#select'+i).comboSelect();
                }
            }

        }
    })
    //删除
    $(document).on('click', '.dels', function() {
        var _this = $(this);
        if(_this.parent().parent().parent().parent().parent().index() == $(".nei").length - 1){
        }
        _this.parent().parent().parent().parent().parent().remove();
    })
</script>
<!--$(function(){
$("input[name='sort[]']").each(function(index,item){
alert($(this).val())
}
);
});-->
<!--提交测试-->
<script type="text/javascript">
    $("#sendMail").click(function () {
        var url = "{:url('editSave')}";
        var order = $("#order").val();//唯一id
        var id = $("#id").val();//金豆数量集合
        var num = $("#num").val();
        var prop = $("#prop").val();
        /*if(uids==""){
            layer.msg('<span style="margin-left: 30px;">玩家不能为空为空,请至少选择一个玩家!</span>', {icon: 2,time: 2500});
        }*/
        //else {
            /*layer.msg('<span style="margin-left: 30px;">正确!</span>', {icon: 1,time: 2500});
            $.ajax({
                url:url,
                type:"post",
                data:{order:order,id:id,num:num,prop:prop},
                dataType:"json",
                success:function (data) {
                    console.log(data);
                },
                error:function () {
                    console.log("fail");
                }
            })*/
        //}
        if(num==""){
            layer.msg('<span style="margin-left: 30px;">数量不能为空!</span>', {icon: 2,time: 2500});
        }
        else if(prop==""){
            layer.msg('<span style="margin-left: 30px;">概率不能为空!</span>', {icon: 2,time: 2500});
        }
        else {
            layer.msg('<span style="margin-left: 30px;">正确!</span>', {icon: 1,time: 2500});
            $.ajax({
                url:url,
                type:"post",
                data:{order:order,id:id,num:num,prop:prop},
                dataType:"json",
                success:function (data) {
                    console.log(data);
                },
                error:function () {
                    console.log("fail");
                }
            })
        }
    })
</script>